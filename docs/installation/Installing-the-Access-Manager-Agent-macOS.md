# Installing the Access Manager Agent on macOS
![](../images/badge-enterprise-edition-rocket.svg) Lithnet LAPS is an [Enterprise edition feature](/about-ams/Access-Manager-Editions)

## Prerequisites
The agent must be able to validate the AMS server certificate. If you are using a self-signed certificate, you'll need to [add this certificate](https://support.apple.com/en-au/guide/keychain-access/kyca2431/mac) to the system keychain, and [configure it to be trusted](https://support.apple.com/en-au/guide/keychain-access/kyca11871/mac).

The agent itself runs using launchd, and as it requires access to reset the root password, must be run as the root user.

### OS requirements
The agent requires OSX 10.14 or later.

If running on Apple Silicon (M1 chip), Rosetta 2 must be installed.

## Installing the agent
You can open the package from finder, or use the `installer` command line tool to install the package
```shell
sudo installer -pkg /path/to/installer.pkg -target /
```

## Configuring the agent
Once the package is installed, it must be configured to talk to your AMS server. You can run the following command to perform an interactive installation

```shell
/Applications/LithnetAccessManagerAgent/Lithnet.AccessManager.Agent --setup
```

To perform a non-interactive installation, use the following command, replacing the server name, and registration key as appropriate. You can generate new registration keys using the AMS configuration tool.

```shell
/Applications/LithnetAccessManagerAgent/Lithnet.AccessManager.Agent --server ams.lithnet.local --registration-key XXXX
```

Check the log using the instructions in the `Viewing the log files` section below to ensure the agent registered correctly.

## Restarting the agent
The Lithnet Access Manager Agent runs as a daemon using launchd. You can use standard launchd commands to start, stop and restart the agent.

```shell
launchctl kickstart -k system/io.lithnet.accessmanager.agent
```

## Uninstalling the agent
You can use the uninstallation script provided to remove the agent from the computer.

```shell
/Applications/LithnetAccessManagerAgent/uninstall.sh
```

## Viewing log files
The agent logs can be viewed using the `Console` app, or using the command line

To show all events in the log use the following command
```shell
tail /Library/Logs/Lithnet/AccessManagerAgent/LithnetAccessManagerAgent.log
```

To show a live stream of log messages use the following command
```shell
tail -f /Library/Logs/Lithnet/AccessManagerAgent/LithnetAccessManagerAgent.log
```

## File locations
The agent creates and uses the following files and folders.

`/Library/Application support/Lithnet/AccessManagerAgent/LithnetAccessManagerAgent.conf` - The main configuration file for the application. This contains the AMS server name and other settings relevant to the application.

`/Library/Application support/Lithnet/AccessManagerAgent/LithnetAccessManagerAgent.state` - This contains  information used by the agent to store its current state information. This file should not be modified. It is generated by the app when it is run, and is not part of the installation package.

`/Applications/LithnetAccessManagerAgent` - This directory contains the application binary files.

`/Library/Logs/Lithnet/AccessManagerAgent/` - This directory contains the agent log files.

`/Library/LaunchDaemons/io.lithnet.accessmanager.agent.plist` - The launchd entry for the agent, symlinked from the application directory.