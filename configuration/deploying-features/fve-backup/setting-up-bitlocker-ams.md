# Setting up BitLocker recovery key backup and access using the Access Manager Agent

This guide will walk you through setting up the Access Manage agent to backup BitLocker encryption keys, and access them via the AMS web app.

{% hint style="info" %}
BitLocker recovery policies can only be configured for Windows agents.
{% endhint %}

## Step 1: Enable agent support on the AMS server

Follow the steps in [Enabling agent support on the AMS server](../../../installation/installing-the-access-manager-agent/enabling-agent-support.md)

## Step 2: Deploy the Access Manager agents

Deploy the [Access Manager agent to your devices](../../../installation/installing-the-access-manager-agent/installing-the-access-manager-agent.md).

## Step 3: Create an encryption certificate

Access Manager requires an *encryption certificate* to be configured, to facilitate encryption of BitLocker keys.

From the `Access Manager Agent/Password settings` page, press the `Generate new...` button, to create a new encryption certificate.

{% hint style="warning" %}
Backup this certificate when prompted and store it in a safe place. If you lose this certificate, you will not be able to decrypt any passwords stored in the directory. There are no other recovery options.
{% endhint %}

{% hint style="info" %}
These certificates can be generated by AMS itself, or imported. Depending on your threat model, you may elect to store this certificate in other cryptographic backend supported by Windows CNG, such as a hardware security module (HSM).
{% endhint %}

![](../../../images/ui-page-access-manager-agent-password-settings.png)

## Step 4: Configure Access Manager Agent policy
AMS uses *agent policies* to configure the behavior of Lithnet Access Manager agents.

From the `Access Manager agent/Agent policies/Windows policies` page, find or create a policy that applies to the computers you want to backup the BitLocker encryption keys for.

See the guide on [creating and managing policies](../../../help-and-support/advanced-help-topics/setting-up-agent-policies.md) for more information on policy targeting and creation.

![](../../../images/ui-page-access-manager-agent-agent-policies-windows-policies-edit-bitlocker.png)

## Step 5. Configure the types of keys to backup
Edit the policy, and choose the types of encryption keys you want to back up.

| Setting | Description |
| --- | --- |
| Enable backup of OS drive encryption keys | Backs up encryption keys for the operating system drive (usually `C:`)|
| Enable backup of fixed drive encryption keys | Backs up encryption keys for other fixed drives, excluding the operating system drive |
| Enable backup of removable drive encryption keys | Backs up encryption keys for removable drives, such as USB drives |

{% hint style="info" %}
The Access Manager agent only backs up keys for drives that are already encrypted. It will not turn on BitLocker for drives that are not encrypted.
{% endhint %}

## Step 6: Assign access

Create an authorization rule, granting permission for your selected users and groups to access the BitLocker recovery passwords for the specified computers.

From the `Authorization rules/Computers` page, select `Add...` to create a new rule. Select the  tenant, directory, device group, or computer you want to assign access to, and provide a friendly description for this rule. This will appear in audit logs if a user is granted access.

Expand the `Access control` section and select `Edit Permissions...` to open the ACL editor.

![](../../../images/ui-page-authz-editsecurity-bitlocker.png)

If you'd like to be notified when someone accesses a BitLocker recovery password, select the notification channels you'd like to send to for success and failure events.

## Step 7: Validate access
Log in to the Access Manager web app as an authorized user, and request access to the recovery password for a computer. If you have performed the steps correctly, you should be able to see the machine's recovery password.

If passwords cannot be retrieved, double check that you have followed the steps in this article, and see the [troubleshooting guide](../../../help-and-support/troubleshooting.md) for how to find the Access Manager server logs to help understand and resolve the issue.